
<!DOCTYPE html>
<head>
    <title id="titol"></title>
    <link rel="icon" type="image/x-icon" href=img/favicon.png>
    <link rel="stylesheet" type="text/css" href="css/main.css" />
    <meta charset="UTF-8">
</head>
<textarea id="enunciat">


~~~
&nbsp;
    Permutació: [[p2]]
&nbsp;
~~~

## Normes:
- S'ha de **gravar la pantalla COMPLETA**, sense micròfon, webcam ni so.
  Pots utilitzar la web
  [Screen Capture](https://www.screencapture.com/es/).
- No es poden utilitzar apunts.
- Només es pot tenir una finestra oberta (la del navegador Chrome).
- Només es pot tenir una pestanya oberta (la de l'examen).
- Si en aquest examen es pot utilitzar reglaments o documentació tècnica
  també es poden tenir oberts. S'especifica a la tasca associada.
- Està terminantment prohibit copiar o mirar al company.
- No es poden fer preguntes. Part de l'avaluació és la comprensió del
  text. Si hi ha algun error es parlarà una vegada l'examen hagi
  finalitzat, i en el seu cas s'anul·larà la pregunta.
- L'examen dura el que indiqui la tasca associada i **es tanca
  automàticament. ENTREGUEU-HO ABANS** o serà un zero.
- Qualsevol incompliment serà sancionat amb un zero.
- Les preguntes correctes sumen 1 punt, les incorrectes
  resten 1/(numrespostes - 1) punts, les que es deixen en blanc,
  ni sumen ni resten.

## Com fer aquest examen:
- Ves a [Screen Capture](https://www.screencapture.com/es/).
- Recorda llevar micròfon, so i webcam.
- Clica a «iniciar grabación».
- Clica a la pestanya «toda la pantalla».
- Ara clica a la miniimatge del teu escriptori que posa de nou
  «toda la pantalla».
- Clica compartir.
- Agafa paper
- Comença a escriure les respostes al paper.
- Si una resposta es vol deixar en blanc escriu una n.
- Quan acabis copia les respostes sense espais i tot seguit, al camp
  «resposta», si no la saps n. Per exemple: abnaac
- Omple el teu nom i clica a avaluar.
- Imprimeix la pàgina com a pdf fent «Ctrl + P»
- Atura el vídeo fent click a «volver a la configuración».
- Descarrega el vídeo  clicant a «descargar».
- Adjunta-la com a tasca.
- Adjunta el vídeo.
- Fotografia el paper utilitzat (la fotografia és per a tu, per a
  poder revisar l'examen si ho necessitessis).
- Entrega els papers utilitzats.

## Preguntes

[[p1]]

## Resposta

[[i1]]



</textarea>
<!-- FI ENUNCIAT ================================================== -->







<!-- C. SCRIPT ==================================================== -->
<script>
    window.texme = {
        renderOnLoad: false,
        style: 'none',
        markdownURL: 'js/marked/marked.min.js',
        MathJaxURL: 'js/mathjax/es5/tex-mml-chtml.js'
    }
    const titol = "Examen UT06 - part 1"; // MODIFICAR
</script>
<script src="js/texme/texme.js"></script>

<script>
// # 1. CONSTANTS (actualitzar) ---------------------------------------
const puntuacions = ["", 10];


// # 2. PARÀMETRES ====================================================

// ## 2.1. DECLARACIÓ (actualitzar) -----------------------------------

let p01 = "";
const preguntes = [
  [
    "Quina és la tensió nominal màxima que s'aplica a les LSMT descrites en el DYZ10000?",
    "30 kV.",
    "20 kV.",
    "36 kV.",
    "50 kV."
  ],
  [
    "Quin tipus d'aïllament utilitzen els cables de potència descrits en el DYZ10000?",
    "Polietilè reticulat (XLPE).",
    "PVC.",
    "Paper impregnat.",
    "EPR (Etilè Propilè)."
  ],
  [
    "Quina és la temperatura màxima admissible en el conductor durant un curtcircuit de menys de 5 segons?",
    "250 ºC.",
    "90 ºC.",
    "180 ºC.",
    "120 ºC."
  ],
  [
    "Els suports de LAMT han de estar connectats a terra?",
    "Sí, ja que el neutre s'ha de posar reiteradament a terra.",
    "No, ja que la terra està formada pel conductor de terra que va a dalt de les linies (a vegades associat a la fibra òptica).",
    "Sí, excepte en els de fusta que no són conductors.",
    "Només els suports amb tensions superiors a 20 kV.",
  ],
  [
    "Identifica la creuera falsa",
    "En bandera",
    "En tresbolillo",
    "Boveda",
    "Zigzag",
  ],
  
  
  
  [
    "Es pot colocar una linia de MT a una safata?",
    "Sí, sempre que estigui a més de 2,5 m d'altura.",
    "No, sempre han d'anar soterrades, entubades o sobre aïlladors donat el seu elevat voltatge.",
    "Sí, per exemple a les galeries visitables.",
    "No, ja que les safates poden acumular aigua.",
  ],
  [
    "Quina és la funció principal dels interruptors automàtics en una xarxa elèctrica de mitjana tensió?",
    "Establir, mantenir i interrompre el corrent en condicions normals.",
    "Establir, mantenir i interrompre el corrent en condicions normals i protegir contra sobretensions.",
    "Seccionar una xarxa elèctrica fent visible el tall.",
    "Establir, mantenir i interrompre el corrent en condicions normals, i protegir contra sobreintensitats i curtcircuits.",
  ],
  [
    "Quin tipus d'interruptor utilitzen les cel·les d'un CT a interior d'edifici a les que arribaran les línies d'MT?",
    "Interruptors amb hexafluorur de sofre (SF6).",
    "Interruptors d'aire.",
    "Interruptors d'oli.",
    "Interruptors de buit.",
  ],
  [
    'Fixa\'t en la imatge d\'aquesta cel·la de línia Ormazabal, quins elements de maniobra o protecció du?<br/><img src="img/UT06_exam01_02.png">',
    "Dos interruptors",
    "Interruptor seccionador el de l'esquerra, seccionador el de la dreta",
    "Interruptors automàtic el de l'esquerra, interruptor el de la dreta.",
    "Interruptor el de l'esquerra, interruptor automàtic el de la dreta. ",
  ],
  [
    "Quina és la funció de les autovàlvules en la protecció contra sobretensions?",
    "Limitar el valor de les sobretensions derivant el corrent a terra.",
    "Augmentar la resistència dielèctrica dels aïlladors.",
    "Refredar els conductors durant sobrecàrregues.",
    "Millorar la conductivitat dels cables.",
],
];

let permutacio = "";
const num_preg = preguntes.length;
const num_resp = preguntes[0].length-1;
const fact_np = factorial(num_preg);
const fact_nr = factorial(num_resp);
/*let ordre_preg = Math.floor(aleat(0, fact_np - 1)/1e16)*/;
let ordre_preg = aleat(0, fact_np - 1);

console.log(ordre_preg)
permutacio += ordre_preg + "_";
//ordre_preg *= 1e16;

const preg_ordenades = obtenirPermutacio(preguntes, ordre_preg);

for (let i = 0; i < num_preg; i++){
    p01 += '<p><b>' + (i+1) + '.</b> ' + preg_ordenades[i][0] + '</p>';
    let ordre_resp = aleat (0, fact_nr - 1);
    permutacio += ordre_resp + ".";

    let resp = obtenirPermutacio(preg_ordenades[i].slice(1), ordre_resp);
    p01 += '<ol style="list-style-type: none;">'
    for (let j = 0; j < num_resp; j++){
        p01 += '<li class="preg"><span><i>' + nombreALletra(j+1) +
               '</i>) </span><span style="flex: 1;">' +
               resp[j] + "</span></li>"
    }
    p01 += "</ol>"
}

p02 = permutacio;





// ## 2.2 FUNCIO (actualitzar) ----------------------------------------
// !!! CONVERTIR si és necessari les unitats a les unitats que requereix
// el nostre enunciat.

function estableixParametres(){
    array = [
      p01, p02
    ];
    parametres = parametres.concat(array);  // no tocar aquesta línia
}




// # 3. CALCULS =======================================================

// ## 3.1 CALCUL VALORS (ACTUALITZAR) ---------------------------------
function calcula(){

}





// # D. ENTRENADOR SERVERI ============================================


// # 1. VARIABLES GLOBALS =============================================

let txtEnunciat = "";   // l'enunciat de l'apartat B.
let parametres = [""];  // els paràmetres del punt 3.1.
let solucions = [""];   // els valors que ha donat el programa.
let respostes = [""];   // els valors que ha donat l'alumne.
let alumne = {
    nom: "",
    cicle: "CFGS Tècnic superior en sistemes electrotècnics i automàtics",
    anys: "2024/2025"
}
let tlog = "";          // log que apareix al final de l'avaluació.



// # 2. FUNCIONS ======================================================




window.onload = function (){
    // txtEnunciat és una variable global
    txtEnunciat = document.getElementById("enunciat").value;
    renderEnunciat(txtEnunciat);
}

function renderEnunciat(){
    let txt = "";
    estableixParametres(); // Va al punt 3.2. de l'apartat C. (script)
    txt = '<h1 align ="center">' + titol + "</h1>\n&nbsp;\n\n" +
          txtEnunciat;
    txt = exportarParametres(txt);
    txt = crearInputs(txt);
    txt = crearIdentificacio(txt);
    document.getElementById("enunciat").innerHTML = txt;
    document.getElementById("titol").innerText = titol;
    texme.renderPage();
}

function exportarParametres(txt){
    let patro = "", canvi = "";
    const fi = parametres.length;
    for (let i = 1; i < parametres.length; i++) {
        patro = "[[p" + i +"]]";
        canvi = parametres[i];
        txt = txt.replace(patro, canvi);
    }
    return txt;
}

function crearInputs(txt){
    let patro = "", canvi = "";
    for (let i = 1; i < puntuacions.length; i++) {
        patro = "[[i" + i +"]]";
        canvi = '<input type="text" onwheel="return false;" ';
        canvi += 'id="i'+ i +'" style="width: 300px">';
        txt = txt.replace(patro, canvi);
    }
    return txt;
}

function crearIdentificacio(txt){
txt += `
<h2>Identificació de l'alumne</h2>

<form id="avalua" onsubmit="event.preventDefault() & avalua()">
    <label>Nom de l'alumne: </label>
    <input id="nom" style="width: 400px"/>
    <div>
        <input type="checkbox" id="informat" required/>
        <label>
            Entenc que al premer el botó avaluar no es pot tornar
            enrera.
        </label>
    </div>
    <br/>
    <div style="text-align: center;">
        <button type="submit" id="boto"
            style="font-size: 20px; color: #AA5050;">
            Avaluar
        </button>
    </div>
</form>
`; return txt;
}

function avalua(){
    importaRespostes();
    resetejar();
    renderAvaluacio();
}

function importaRespostes(){
    respostes[0] = document.getElementById("i1").value
    alumne.nom = document.getElementById("nom").value;
}

function resetejar(){
    const ppal = document.getElementsByTagName("main")[0];
    const body = ppal.parentNode;
    const textArea = body.appendChild(document.createElement("textarea"));
    body.removeChild(ppal);
    textArea.setAttribute("id", "avaluacio");
}

function renderAvaluacio(){
    let txt = "";
    txt += '<h1 align="center"> Avaluació</h1>\n' +
           '<h2 align="center" style="color: #888">' + titol +
           "</h2>\n&nbsp;\n\n"
    txt += [
    "## Presentació de resultats",
    "",
    "L'alumne **[[nom]]**, del [[cicle]] (any [[any]]) serà qualificat manualment.",
    "",
    ].join("\n") + "\n";
    txt += txtEnunciat;

    txt = identificarAlumne(txt);
    txt = puntua(txt);
    txt = txt.replace("## Identificació de l'alumne:\n\n"+
        "[[identificacio]]", "");
    txt +=  "\n" + tlog + "\n";
    document.getElementById("avaluacio").innerHTML = txt;
    texme.renderPage();
}

function identificarAlumne(txt){
    txt = txt.replace("[[nom]]", alumne.nom);
    txt = txt.replace("[[cicle]]", alumne.cicle);
    txt = txt.replace("[[any]]", alumne.anys);
    return txt;
}

function puntua(txt){
    calcula();

    txt = exportarParametres(txt);

    patro = "[[i1]]";
    canvi = "~~~\n    " + respostes[0] + "\n\n\n~~~";

    txt = txt.replace(patro, canvi);

    return txt;
}












function aleat(min, max) { // enter aleat entre min i max (inclosos)
    const a = Math.ceil(min);
    const b = Math.floor(max);
    const c = Math.floor(Math.random() * (b - a + 1) + a);
    return c;
}

function triaElementMatriu (matriu){
    const aleat = Math.floor(Math.random() * (matriu.length));
    return matriu[aleat.toFixed(0)];
}

function factorial(n) {
    return n <= 1 ? 1 : n * factorial(n - 1);
}

// Funció per obtenir la permutació d'un índex específic
function obtenirPermutacio(array, index) {
    let permutacio = [];
    let elements = array.slice(); // Copia de l'array per a evitar
                                  // modificar l'original
    let n = elements.length;

    // Calcular la permutació utilitzant factorials
    for (let i = 0; i < n; i++) {
        let fact = factorial(n - i - 1);
        let posicio = Math.floor(index / fact);
        permutacio.push(elements[posicio]);
        elements.splice(posicio, 1);
        index %= fact;
    }

    return permutacio;
}

function permutacions(array) {

    let resultat = [];

    // Funció recursiva per a generar les permutacions
    function generarPermutacions(actual, resta) {
        if (resta.length === 0) {
            resultat.push(actual);
        } else {
            for (let i = 0; i < resta.length; i++) {
                let actualNova = actual.concat(resta[i]);
                let restaNova = resta.slice(0, i).concat(resta.slice(i + 1));
                generarPermutacions(actualNova, restaNova);
            }
        }
    }

    generarPermutacions([], array);
    return resultat;
}


function nombreALletra(nombre) {
    const ascii = 97; // Código ASCII de 'a'
    if (nombre >= 1 && nombre <= 26) {
        // Convertir el número en el carácter correspondiente usando el código ASCII
        return String.fromCharCode(ascii + nombre - 1);
    } else {
        return null; // Retornar null si el número está fuera de rango
    }
}

</script>
